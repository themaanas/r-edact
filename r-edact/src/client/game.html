<!DOCTYPE html>
<html lang="en">
  <head>
    <link rel="stylesheet" type="text/css" href="game/game.css" />
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, width=device-width, height=device-height, user-scalable=0"
    />
    <title>r/edact</title>
  </head>
  <body class="app">
    <!-- Header -->
    <header class="header">
      <h1 class="logo">r/<span class="logo-redacted">edact</span></h1>
      <p class="tagline">Guess the subreddit</p>
      <div class="puzzle-number" id="puzzle-number">#1</div>
    </header>

    <!-- Main Game Area -->
    <main class="game-container">
      <!-- Post Display -->
      <section class="post-card">
        <div class="post-header">
          <span class="subreddit-redacted">r/<span class="redact-block">????????????</span></span>
        </div>
        <h2 class="post-title" id="post-title">Loading...</h2>
        <p class="post-body" id="post-body"></p>
        <div class="clues-section" id="clues-section"></div>
      </section>

      <!-- Combined Progress Section -->
      <section class="progress-section">
        <div class="progress-header">
          <h3 class="section-title">Progress</h3>
          <span class="guess-counter" id="guess-counter">0/5 guesses</span>
        </div>

        <div class="progress-timeline" id="progress-timeline">
          <!-- Timeline items will be rendered dynamically -->
          <!-- Empty state shown initially -->
          <div class="timeline-empty" id="timeline-empty">
            <p>Make your first guess below!</p>
          </div>
        </div>

        <div class="input-container" id="input-container">
          <div class="input-wrapper">
            <span class="input-prefix">r/</span>
            <input
              type="text"
              id="guess-input"
              class="guess-input"
              placeholder="Type subreddit name..."
              autocomplete="off"
              autocapitalize="off"
              spellcheck="false"
            />
            <div class="autocomplete-dropdown" id="autocomplete-dropdown"></div>
          </div>
          <button class="submit-button" id="submit-button">Guess</button>
        </div>
      </section>

      <!-- Stats Bar -->
      <section class="stats-bar" id="stats-bar">
        <div class="stat-item">
          <span class="stat-icon">üî•</span>
          <span class="stat-value" id="streak-value">0</span>
          <span class="stat-label">Streak</span>
        </div>
        <div class="stat-item">
          <span class="stat-icon">‚≠ê</span>
          <span class="stat-value" id="total-score-value">0</span>
          <span class="stat-label">Total</span>
        </div>
        <div class="stat-item">
          <span class="stat-icon">üéÆ</span>
          <span class="stat-value" id="games-played-value">0</span>
          <span class="stat-label">Played</span>
        </div>
      </section>
    </main>

    <!-- Results Modal -->
    <div class="modal-overlay" id="results-modal">
      <div class="modal-content">
        <h2 class="modal-title" id="modal-title">Solved!</h2>
        <p class="modal-answer">The answer was <strong id="correct-answer">r/???</strong></p>
        <div class="modal-score">
          <span class="score-label">Your score:</span>
          <span class="score-value" id="final-score">0</span>
          <span class="score-suffix">points</span>
        </div>
        <div class="modal-guesses">
          <span id="guesses-used">0</span>/5 guesses used
        </div>
        <div class="modal-buttons">
          <button class="modal-button share-button" id="share-button">Share</button>
          <button class="modal-button leaderboard-button" id="view-leaderboard-button">Leaderboard</button>
        </div>
        <button class="modal-close" id="close-results-button">√ó</button>
      </div>
    </div>

    <!-- Leaderboard Modal -->
    <div class="modal-overlay" id="leaderboard-modal">
      <div class="modal-content leaderboard-modal-content">
        <h2 class="modal-title">Today's Leaderboard</h2>
        <div class="leaderboard-container">
          <table class="leaderboard-table">
            <thead>
              <tr>
                <th>#</th>
                <th>Player</th>
                <th>Guesses</th>
                <th>Score</th>
              </tr>
            </thead>
            <tbody id="leaderboard-body">
              <tr>
                <td colspan="4" class="loading-row">Loading...</td>
              </tr>
            </tbody>
          </table>
        </div>
        <div class="user-rank" id="user-rank-display"></div>
        <button class="modal-close" id="close-leaderboard-button">√ó</button>
      </div>
    </div>

    <!-- No Puzzle Message -->
    <div class="no-puzzle-overlay" id="no-puzzle-overlay">
      <div class="no-puzzle-content">
        <h2>No Puzzle Today</h2>
        <p>Check back later for today's puzzle!</p>
      </div>
    </div>

    <script type="module" src="game/game.ts" defer></script>
  </body>
</html>
